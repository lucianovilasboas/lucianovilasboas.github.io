<!DOCTYPE html>
<html>
<body>

<h2>O que o JavaScript pode fazer?</h2>

<p>JavaScript pode alterar os valores dos atributos HTML.</p>

<p>Nesse caso, o JavaScript altera o valor do atributo src (fonte) de uma imagem.</p>


<div style="text-align: center;">

    <button id="turn_on">Ligar</button>

    <img id="myImage" src="pic_bulboff.gif" style="width:100px">

    <button id="turn_off">Desligar</button>

    <br>
    <br>

    <p>Experimente por voz!</p>
    <button id="voice">Ativar microfone</button>

</div>


<script>
    const turn_onBt = document.querySelector("#turn_on");
    const turn_offBt  = document.querySelector("#turn_off");
    const lamp  = document.querySelector("#myImage");
    const voiceBt  = document.querySelector("#voice");


    const recognition = new webkitSpeechRecognition();
    recognition.continuous=true;
    recognition.lang="pt-BR";
    recognition.interimResults=false;
    recognition.maxAlternatives=1;
    

    turn_onBt.addEventListener("click", (e) => {
        lamp.src='pic_bulbon.gif';
    });

    turn_offBt.addEventListener("click", (e) => {
        lamp.src='pic_bulboff.gif';
    });


    voiceBt.addEventListener("click", (e) => {
        try{
          recognition.start();
          voiceBt.innerHTML = "Desativar microfone";
        } catch {
          recognition.stop();
          voiceBt.innerHTML = "Ativar microfone";
        }
    });

    // const re_on  = /ligar|acender/gi;
    // const re_off = /apagar|desligar/gi;

    recognition.onresult = (e) => {

       const transcript = e.results[e.results.length - 1][0].transcript.trim();
       let text = transcript.toLocaleLowerCase();


       if (text == 'ligar' || text == 'acender')
       {
            turn_onBt.click();
       }
       else if (text == 'desligar' || text == 'apagar')
       {
            turn_offBt.click();
       }

       console.log(text);

    };

    // recognition.start();

</script>


</body>
</html>
